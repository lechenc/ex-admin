(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2f451981"],{"4c62":function(e,t,r){},"5e4b":function(e,t,r){"use strict";var a=r("d9a1"),n=r.n(a);n.a},b46d:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"notice-container"},[r("div",{staticClass:"container-top"},[r("Bsearch",{attrs:{configs:e.searchConfig},on:{"do-search":e.doSearch,"do-reset":e.doReset}})],1),e._v(" "),e.isCURDAuth?r("div",{staticClass:"notice-button"},[r("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.createBanner}},[e._v("添加海报")])],1):e._e(),e._v(" "),r("div",[r("Btable",{attrs:{listLoading:e.listLoading,data:e.list,configs:e.configs},on:{"do-handle":e.doHandle}})],1),e._v(" "),r("PosterDialog",{attrs:{visible:e.show_detail_modal,row:e.row,type:e.show_modal_type},on:{"update:visible":function(t){e.show_detail_modal=t},"update:row":function(t){e.row=t},freshData:e.getList,close:e.closeDialog}})],1)},n=[],i=(r("ac6a"),r("96cf"),r("3b8d")),s=r("c249"),o=r("2fee"),l=r("2ab6"),c=r("4ec3"),u=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"bannerDia-container"},[r("BDialog",{attrs:{width:"600px",title:e.title,visible:e.showDialog,closeOnClickModal:!1},on:{"update:visible":function(t){e.showDialog=t},open:e.dialogOpen}},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[r("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{label:"id",prop:"id"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.id,callback:function(t){e.$set(e.form,"id",t)},expression:"form.id"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"类型",prop:"bannerType"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.bannerType,callback:function(t){e.$set(e.form,"bannerType",t)},expression:"form.bannerType"}},e._l(e.bannerTypeList,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"名称",prop:"bannerName"}},[r("el-input",{attrs:{size:"small",placeholder:"请输入海报名称",id:"bannerName"},model:{value:e.form.bannerName,callback:function(t){e.$set(e.form,"bannerName","string"===typeof t?t.trim():t)},expression:"form.bannerName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"中文图片",prop:"imgUrl"}},[r("el-input",{attrs:{size:"small",placeholder:"请选择上传,长宽比例为0.56~0.565之间"},model:{value:e.form.imgUrl,callback:function(t){e.$set(e.form,"imgUrl",t)},expression:"form.imgUrl"}},[r("el-upload",{ref:"upzh",attrs:{slot:"append","file-list":e.fileList,action:e.$img_api,multiple:"",name:"file",data:{type:"exchange"},"on-success":e.uploadZh,"before-upload":e.onBeforeUpload,"on-error":e.uploadError,limit:1,"on-exceed":e.exceed},slot:"append"},[r("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"英文图片",prop:"imgUrlEn"}},[r("el-input",{attrs:{size:"small",placeholder:"请选择上传,长宽比例为0.56~0.565之间"},model:{value:e.form.imgUrlEn,callback:function(t){e.$set(e.form,"imgUrlEn",t)},expression:"form.imgUrlEn"}},[r("el-upload",{ref:"enzh",attrs:{slot:"append",action:e.$img_api,multiple:"",name:"file",data:{type:"exchange"},"show-file-list":!0,"on-success":e.uploadEn,"before-upload":e.onBeforeUpload,"on-error":e.uploadError,limit:1,"on-exceed":e.exceed},slot:"append"},[r("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1)],1),e._v(" "),r("div",{staticClass:"spance"}),e._v(" "),r("el-form-item",{attrs:{label:"排序",prop:"weight"}},[r("el-input",{attrs:{size:"small",placeholder:"请输入排序优先级",id:"weight",type:"number"},model:{value:e.form.weight,callback:function(t){e.$set(e.form,"weight","string"===typeof t?t.trim():t)},expression:"form.weight"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"客户端",prop:"deviceType"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.deviceType,callback:function(t){e.$set(e.form,"deviceType",t)},expression:"form.deviceType"}},e._l(e.deviceList,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"上架",prop:"bannerStatus"}},[r("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:e.form.bannerStatus,callback:function(t){e.$set(e.form,"bannerStatus",t)},expression:"form.bannerStatus"}})],1)],1),e._v(" "),r("div",{staticClass:"footer"},[r("el-button",{attrs:{size:"small",type:"primary",loading:e.btnLoading},on:{click:e.confirm}},[e._v("确定")]),e._v(" "),r("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.cancel}},[e._v("取消")])],1)],1)],1)},m=[],d=(r("8e6e"),r("456d"),r("bd86")),p=r("a8db"),f=(r("c5f6"),r("0bbc")),h=r("5d48");r("ed08");function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){Object(d["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var v={components:{BDialog:f["a"],BSingleUpload:h["a"]},props:{visible:{default:!1,type:Boolean},row:{default:function(){},type:Object},type:{type:Number,default:0}},computed:{showDialog:{get:function(){return this.visible},set:function(e){this.$emit("close",e)}}},watch:{resulta:function(e){}},data:function(){return{fileList:[],title:"添加海报",btnLoading:!1,rules:{bannerType:[{required:!0,message:"请选择类型",trigger:"change"}],bannerName:[{required:!0,message:"请输入海报名称",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20 个字符",trigger:"blur"}],imgUrl:[{required:!0,message:"请选择中文图片",trigger:"blur"}],imgUrlEn:[{required:!0,message:"请选择英文图片",trigger:"blur"}],weight:[{required:!0,message:"请选择排序权重",trigger:"blur"}],deviceType:[{required:!0,message:"请选择客户端",trigger:"change"}]},loading:!1,form:{id:"",bannerType:"",bannerName:"",imgUrl:"",imgUrlEn:"",weight:"",bannerStatus:!1,deviceType:1},bannerTypeList:[{label:"普通海报",value:1},{label:"会员海报",value:2}],deviceList:[{label:"ios",value:1},{label:"安卓",value:2},{label:"pc,h5",value:3}],resulta:!1,resultb:!1}},methods:{onBeforeUpload:function(e){var t=this,r=e.size/1024/1024<8;if(!r)return this.$message.error("上传文件大小不能超过 8 MB！"),!1;var a=new Promise((function(r,a){var n=new FileReader;n.onload=function(e){var a=e.target.result,n=document.createElement("img");n.src=a,n.onload=function(){n.width/n.height>=.56&&n.width/n.height<=.565?r(!0):(t.$message.error("上传的图片比例不对"),r(!1))}},n.readAsDataURL(e)}));a.then((function(e){e||(t.fileList=[])}))},exceed:function(e,t){this.$message.error("单次只能选择一张图片进行上传！")},uploadZh:function(e,t,r){this.form.imgUrl=e.data[0].url,this.$refs.upzh.handleRemove(t)},uploadEn:function(e,t,r){this.form.imgUrlEn=e.data[0].url,this.$refs.enzh.handleRemove(t)},uploadError:function(){this.$message.error("图片上传失败")},confirm:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this,this.$refs.form.validate(function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(r){var a,n,i,s,o,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!r){e.next=18;break}if(a=t.form,n=a.id,i=a.bannerStatus,s=Object(p["a"])(a,["id","bannerStatus"]),o=b({bannerStatus:i?1:0},s),t.btnLoading=!0,""!==n){e.next=10;break}return e.next=7,c["a"].addPosterInfo(o);case 7:e.t0=e.sent,e.next=13;break;case 10:return e.next=12,c["a"].editPosterInfo(b({id:n},o));case 12:e.t0=e.sent;case 13:l=e.t0,l&&(t.$message({message:l.data.message,type:"success"}),t.$emit("close"),t.$emit("freshData")),t.btnLoading=!1,e.next=19;break;case 18:t.$message.error({title:"提示",message:"请完成表单内容填写再重试"});case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),cancel:function(){this.$emit("close")},dialogOpen:function(){var e=this;this.$nextTick((function(){if(e.$refs.form.resetFields(),1===e.type){var t=e.row,r=t.id,a=t.bannerName,n=t.bannerType,i=t.imgUrl,s=t.imgUrlEn,o=t.weight,l=t.bannerStatus,c=t.deviceType;e.form={id:r,bannerType:n,bannerName:a,imgUrl:i,imgUrlEn:s,weight:o,bannerStatus:l,deviceType:c},e.title="编辑海报"}0===e.type&&(e.title="添加海报",e.form={id:"",bannerType:"",bannerName:"",imgUrl:"",imgUrlEn:"",weight:"",bannerStatus:!1,deviceType:1})}))}}},w=v,y=(r("f14b"),r("0c7c")),_=Object(y["a"])(w,u,m,!1,null,null,null),x=_.exports,$=(r("ca00"),{name:"Poster",components:{Btable:o["a"],Bsearch:s["a"],PosterDialog:x},data:function(){return{isCURDAuth:!0,listLoading:!1,list:[],configs:[],searchConfig:[],search_params_obj:{},current_page:1,pages:0,pageSize:10,total:0,detail_list:[],show_detail_modal:!1,show_modal_type:0,row:{}}},methods:{doHandle:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var r,a,n,s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=t.fn,a=t.row,"edit"===r&&(this.row=a,this.show_modal_type=1,this.show_detail_modal=!0),"delete"===r&&this.$confirm("是否删除此海报?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(i["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c["a"].deletePosterInfo({bannerId:a.id});case 2:t=e.sent,t&&(s.$message({type:"success",message:t.data.message}),s.getList());case 4:case"end":return e.stop()}}),e)})))).catch((function(){})),"switchCoin"!==r){e.next=8;break}return e.next=6,c["a"].editPosterInfo({id:a.id,bannerStatus:a.bannerStatus?1:0});case 6:n=e.sent,n?(this.$message({type:"success",message:n.data.message}),this.getList()):this.getList();case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),doSearch:function(e){this.current_page=1,this.search_params_obj=e,this.search_params_obj.startTime||this.search_params_obj.endTime||(this.search_params_obj.flag=1),this.getList()},doReset:function(){this.search_params_obj={},this.searchConfig.forEach((function(e){e["value"]=""})),this.getList()},closeDialog:function(){this.show_detail_modal=!1},createBanner:function(){this.show_modal_type=0,this.row={},this.show_detail_modal=!0},getList:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.listLoading){e.next=2;break}return e.abrupt("return");case 2:return this.listLoading=!0,this,t={},Object.assign(t,this.search_params_obj),e.next=8,c["a"].getPosterList(t);case 8:r=e.sent,r&&(a=r.data.data,a.forEach((function(e){e["bannerStatus"]=1===e["bannerStatus"]})),this.list=a,this.listLoading=!1);case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},mounted:function(){var e=this.$util.getAuthority("Poster",l["w"],l["x"]);this.configs=e.val,this.isCURDAuth=e.isAdd,this.searchConfig=this.$util.clone(l["y"]),this.getList()}}),O=$,k=(r("5e4b"),Object(y["a"])(O,a,n,!1,null,null,null));t["default"]=k.exports},d9a1:function(e,t,r){},f14b:function(e,t,r){"use strict";var a=r("4c62"),n=r.n(a);n.a}}]);